name : pipeline
on : 
  push : 
    branches : 
    - main
  pull_request : 
    branches : 
    - main

jobs : 
  build : 
    runs-on : ubuntu-latest

    steps : 
      - name : checkout
        uses : actions/checkout@v3

      - name : setup nodejs
        uses : actions/setup-node@v3
        with :
            node-version: 20


      - name : install dep
        run  : npm install

      - name : run test 
        run  : npm run test
      
      - name : build image
        run : docker build -t arul8406/icd-pipeline:test .

      - name: Log in to DockerHub
        uses: docker/login-action@v3
        with:
          username: ${{ secrets.DOCKER_USERNAME }}
          password: ${{ secrets.DOCKER_PASSWORD }}

      - name : push image to registory
        run  : docker push arul8406/icd-pipeline:test

      

      
